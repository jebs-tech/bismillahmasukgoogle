{% extends 'base.html' %}
{% load static %}
{% load humanize %}
{% block title %}{{ match.title }} â€” Detail{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <section class="mb-6">
        <h1 class="text-3xl sm:text-4xl lg:text-5xl font-extrabold text-brand-dark-blue leading-tight mb-2">{{ match.title }}</h1>
        <p class="text-gray-700 flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-gray-500">
              <path fill-rule="evenodd" d="M9.69 18.933l...Z" clip-rule="evenodd" /> 
            </svg>
            <span>{{ match.venue.name }}</span>
        </p>
    </section>

    <section class="mb-10 bg-brand-orange rounded-xl p-4 sm:p-6 shadow">
        <div class="bg-amber-100 rounded-md py-6 px-4 sm:px-6 flex items-center justify-between text-brand-dark-blue">
            <div class="flex items-center gap-3 sm:gap-4 text-center">
                <div class="text-2xl sm:text-3xl font-bold">{{ match.team_a.name.0|default:"A" }}</div>
                <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-white flex items-center justify-center text-xl font-bold border-2 border-brand-dark-blue">?</div>
            </div>

            <div class="text-center">
                <div class="text-base sm:text-lg font-semibold">{{ match.start_time|date:"j F" }}</div>
                <div class="text-sm font-bold">{{ match.start_time|date:"H:i" }}</div>
            </div>

            <div class="flex items-center gap-3 sm:gap-4 text-center">
                <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-white flex items-center justify-center text-xl font-bold border-2 border-brand-dark-blue">?</div>
                <div class="text-2xl sm:text-3xl font-bold">{{ match.team_b.name.0|default:"B" }}</div>
            </div>
        </div>
        
        <div class="mt-6 grid grid-cols-1 sm:grid-cols-3 gap-6 text-sm text-gray-800">
            <div class="flex items-start gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-gray-700 mt-0.5"><path fill-rule="evenodd" d="M5.75 2a...Z" clip-rule="evenodd" /></svg>
                <div>
                    <p class="text-xs font-medium uppercase tracking-wider">Mulai dari</p>
                    <p class="text-sm font-semibold">{{ match.start_time|date:"j F Y" }}</p>
                </div>
            </div>
            <div class="flex items-start gap-3">
                 <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-gray-700 mt-0.5"><path fill-rule="evenodd" d="M9.69 18.933l...Z" clip-rule="evenodd" /></svg>
                <div>
                    <p class="text-xs font-medium uppercase tracking-wider">Lokasi</p>
                    <p class="text-sm font-semibold">{{ match.venue.name }}</p>
                </div>
            </div>
            <div class="sm:text-right">
                 <p class="text-xs font-medium uppercase tracking-wider">Pesan Sekarang</p>
                 <p class="text-sm font-semibold">Mulai dari Rp {{ match.price_from|intcomma }} (termasuk pajak)</p>
                 <button id="book-tickets" class="mt-2 w-full sm:w-auto inline-block bg-brand-dark-blue text-white py-2 px-6 rounded-lg font-semibold hover:bg-opacity-80 transition duration-200 shadow focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-dark-blue">
                     Beli Tiket
                 </button>
            </div>
        </div>
    </section>

    <section class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
        <div class="lg:col-span-2 space-y-8">
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold text-brand-dark-blue mb-3">Detail Pengalaman</h3>
                <div class="prose max-w-none text-gray-700">
                    {{ match.description|linebreaksbr }}
                </div>
            </div>

            <div class="bg-white p-6 rounded-lg shadow" id="seatmap">
                <h3 class="text-xl font-bold text-brand-dark-blue mb-4">Denah Tempat Duduk</h3>
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="flex-1 overflow-x-auto border rounded-lg p-2 bg-gray-50">
                        <img src="{% static 'matches/img/denah_seating.svg' %}" alt="Denah tempat duduk" class="min-w-[400px] h-auto mx-auto" />
                    </div>
                    <div class="w-full md:w-52 lg:w-60 shrink-0">
                        <h4 class="font-semibold text-brand-dark-blue mb-3">Kategori Tempat Duduk</h4>
                        <div class="space-y-2 text-sm">
                            <div class="p-3 rounded-md text-center font-medium" style="background-color:#A5B4FC; color: #1E3A8A;"> Tiket Perunggu
                            </div>
                             <div class="p-3 rounded-md text-center font-medium" style="background-color:#C7F9CC; color: #065F46;"> Tiket Perak
                            </div>
                             <div class="p-3 rounded-md text-center font-medium" style="background-color:#FFF89A; color: #854D0E;"> Tiket Emas
                            </div>
                            </div>
                    </div>
                </div>
            </div>
        </div>

        <aside class="space-y-4 lg:sticky lg:top-8">
            <div class="bg-white p-6 rounded-lg shadow-xl border-t-4 border-brand-orange">
                <h4 class="text-lg font-semibold text-brand-dark-blue">Pesan Sekarang</h4>
                <p class="mt-1 text-sm text-gray-600">Mulai dari Rp {{ match.price_from|intcomma }}</p>
                <button id="open-seat-selection" class="mt-4 w-full bg-brand-orange text-white py-3 rounded-lg font-semibold hover:bg-orange-600 transition duration-200 shadow focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-orange">
                    Beli Tiket
                </button>
            </div>
        </aside>
    </section>

</div>

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function () {

  const bookBtn = document.getElementById('book-tickets');
  const openSeatBtn = document.getElementById('open-seat-selection');
  
  // URL tujuan dengan query parameter ?match_id=...
  const beliTiketUrl = "{% url 'payment:detail_pembeli' %}?match_id={{ match.id }}";

  // Listener untuk tombol pertama
  if (bookBtn) {
    bookBtn.addEventListener('click', () => {
      window.location.href = beliTiketUrl; 
    });
  }
  
  // Listener untuk tombol kedua
  if (openSeatBtn) {
    openSeatBtn.addEventListener('click', () => {
      window.location.href = beliTiketUrl; 
    });
  }
});
</script>

{% endblock %}
{% endblock %}