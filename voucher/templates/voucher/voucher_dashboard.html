{% extends "base.html" %}
{% load humanize %}

{% block content %}
<div class="max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8">
    <h1 class="text-3xl font-bold text-gray-900 mb-6">Manajemen Voucher</h1>
    
    {% for message in messages %}
    <div class="p-3 mb-4 text-sm text-green-700 bg-green-100 rounded-lg" role="alert">
        {{ message }}
    </div>
    {% endfor %}

    <a href="{% url 'voucher:create' %}" class="mb-6 inline-block px-4 py-2 bg-brand-dark-blue text-white rounded-md hover:bg-brand-light-blue transition">
        + Buat Voucher Baru
    </a>

    <div class="bg-white shadow overflow-hidden sm:rounded-lg mt-6">
        <table class="min-w-full divide-y divide-gray-200">
            <thead>
                <tr>
                    <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kode</th>
                    <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nilai</th>
                    <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Penggunaan</th>
                    <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Berlaku Sampai</th>
                    <th class="px-6 py-3 bg-gray-50">Aksi</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for voucher in vouchers %}
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ voucher.code }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        {% if voucher.discount_type == 'FIXED' %}
                            Rp {{ voucher.value|intcomma }}
                        {% else %}
                            {{ voucher.value|floatformat:"0" }}%
                        {% endif %}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        {{ voucher.voucherusage_set.count }} / {{ voucher.max_use_count }}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        {{ voucher.valid_until|date:"d M Y H:i" }}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2">
                        <a href="{% url 'voucher:update' pk=voucher.pk %}" class="text-indigo-600 hover:text-indigo-900">Edit</a>
                        <a href="{% url 'voucher:delete' pk=voucher.pk %}" class="text-red-600 hover:text-red-900">Hapus</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="px-6 py-4 text-center text-gray-500">Tidak ada voucher.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}